<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
{{!--

<body>

</body> --}}
<section class="pt-150 pb-150">
    <div class="card mx-auto card-login">
        <div class="card-body">
            <div class="container">
                <div class="row">
                    <div class="col-lg-10 m-auto">

                        <div class="col-lg-1"></div>
                        <div class="col-lg-6">
                            <div class="login_wrap widget-taber-content p-30 background-white border-radius-5  mx-auto">
                                <div class="padding_eight_all bg-white">
                                    <div class="heading_s1">
                                        <h3 class="mb-30">Create an Account</h3>
                                    </div>
                                    <p class="mb-50 font-sm">
                                        Your personal data will be used to support your experience throughout this
                                        website, to manage access to your account, and for other purposes described in
                                        our privacy policy
                                    </p>
                                    <form id="signup-form">
                                        <div class="form-group">
                                            <input type="text" name="name" placeholder="Name">
                                            <div class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <input type="text" name="email" placeholder="Email">
                                            <div class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <input type="text" name="phone" placeholder="Mobile">
                                            <div class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            <input type="password" name="password" placeholder="Password">
                                            <div class="error-message"></div>
                                        </div>
                                        <div class="form-group">
                                            {{!-- <input required="" type="password" placeholder="Confirm password">
                                            --}}
                                        </div>
                                        <div class="login_footer form-group">
                                            <div class="chek-form">
                                                <div class="custome-checkbox">
                                                    <input class="form-check-input" id="terms" type="checkbox" value="">
                                                    <label class="form-check-label" for="exampleCheckbox12"><span>I
                                                            agree to terms &amp; Policy.</span></label>
                                                </div>
                                            </div>
                                            <a href="page-privacy-policy.html"><i
                                                    class="fi-rs-book-alt mr-5 text-muted"></i>Lean more</a>
                                        </div>
                                        <div class="form-group">
                                            <button type="submit" class="btn btn-dark btn-fill-out btn-block hover-up"
                                                id="submit">Submit &amp;
                                                Register</button>

                                            {{#if existingUser}}
                                            <div class="alert alert-danger" role="alert"><span>Email id already
                                                    exists</span></div>
                                            {{/if}}

                                            {{#if registered}}
                                            <div class="alert alert-danger"><span>Successfully registered, Please
                                                    Login</span></div>
                                            {{/if}}
                                    </form>
                                    {{!-- <div class="divider-text-center mt-15 mb-15">
                                        <span> or</span>
                                    </div>
                                    <ul class="btn-login list_none text-center mb-15">
                                        <li><a href="#" class="btn btn-facebook hover-up mb-lg-0 mb-sm-4">Login With
                                                Facebook</a></li>
                                        <li><a href="#" class="btn btn-google hover-up">Login With Google</a></li>
                                    </ul>
                                    <div class="text-muted text-center">Already have an account? <a href="#">Sign in
                                            now</a></div>
                                </div> --}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>




<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
{{!--
<script src="https://cdn.jsdelivr.net/npm/toastify-js@1.12.0/dist/toastify.min.js"></script> --}}


<script>
    function checkAgreement() {
        var checkbox = document.getElementById("terms");
        var button = document.getElementById("submit");

        if (!checkbox.checked) {
            return false;
        } else {
            button.disabled = false;
        }
    }
</script>



<script>
    // Get the form element
    const form = document.querySelector('form');
    //console.log(form)

    // Add event listener for form submission
    form.addEventListener('submit', function (event) {
        // Prevent the form from being submitted
        event.preventDefault();

        // Perform form validation
        const nameInput = document.querySelector('input[name="name"]');
        const emailInput = document.querySelector('input[name="email"]');
        const phoneInput = document.querySelector('input[name="phone"]');
        const passwordInput = document.querySelector('input[name="password"]');
        console.log("Name", nameInput.value)
        let isValid = true;

        // Validate name field
        if (nameInput.value.trim() === '') {
            isValid = false;
            nameInput.classList.add('is-invalid');
            nameInput.nextElementSibling.textContent = 'Please enter your name.';
        } else {
            nameInput.classList.remove('is-invalid');
            nameInput.nextElementSibling.textContent = '';
        }

        // Validate email field
        const emailRegex = /^\S+@\S+\.\S+$/;
        if (emailInput.value.trim() === '' || !emailRegex.test(emailInput.value)) {
            isValid = false;
            emailInput.classList.add('is-invalid');
            emailInput.nextElementSibling.textContent = 'Please enter a valid email address.';
        } else {
            emailInput.classList.remove('is-invalid');
            emailInput.nextElementSibling.textContent = '';
        }


        // Validate phone field
        const phoneRegex = /^[1-9]\d{9,}$/;
        if (phoneInput.value.trim() === '' || !phoneRegex.test(phoneInput.value)) {
            isValid = false;
            phoneInput.classList.add('is-invalid');
            phoneInput.nextElementSibling.textContent = 'Please enter a valid phone number with at least 10 digits and the first digit should not be zero.';
        } else {
            phoneInput.classList.remove('is-invalid');
            phoneInput.nextElementSibling.textContent = '';
        }

        // Validate password field
        if (passwordInput.value.trim() === '') {
            isValid = false;
            passwordInput.classList.add('is-invalid');
            passwordInput.nextElementSibling.textContent = 'Please enter your password.';
        } else {
            passwordInput.classList.remove('is-invalid');
            passwordInput.nextElementSibling.textContent = '';
        }


        // If form is valid, submit it

        if (isValid) {
            const formData = {
                name: nameInput.value,
                email: emailInput.value,
                phone: phoneInput.value,
                password: passwordInput.value
            };

            $.ajax({
                type: "POST",
                url: "/signup",
                data: JSON.stringify(formData),
                contentType: "application/json",
                success: function (response) {
                    console.log("Success", response);
                    Toastify({
                        text: "User Successfully Registered... Please LogIn",
                        duration: 3000, // Set the duration for which the toast should be displayed (in milliseconds)
                        close: true, // Enable the close button on the toast
                        gravity: "center", // Display the toast at the top of the screen
                        backgroundColor: "green", // Set the background color of the toast
                        stopOnFocus: true, // Stop the toast from automatically disappearing when it receives focus
                        style: {
                            top: "20px",
                            left: "550px",
                            width: "300px",
                            height: "auto"
                        }
                    }).showToast();
                    setTimeout(function () {
                        window.location.href = '/login'

                    }, 2000)

                    //location.reload();
                    // Handle success response
                },
                error: function (error) {
                    console.log("Error", error);
                    Toastify({
                        text: "User Registration Failed !!!!!!",
                        duration: 5000,
                        close: true,
                        gravity: "center",
                        backgroundColor: "#FFFFFF",


                        stopOnFocus: true,
                        style: {
                            top: "20px",
                            left: "550px",
                            width: "300px",
                            height: "auto",
                            backgroundColor: "red",
                            color: "red"
                        }
                    }).showToast();
                    // window.location.href='/login'
                    /// location.reload();
                    // Handle error response

                }
            });
        }
    });
</script>
</body>